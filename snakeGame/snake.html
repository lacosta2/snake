<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Snake</title>
    <link rel="stylesheet" href="snake.css">
  </head>
  <body>
    <h1>Snake</h1><br>
    <canvas id="snakeCanvas" width="500" height="500"></canvas>
    <div id="x">SCORE:</div>
    <div id="score">0</div>
    <script>
      var canvas = document.getElementById("snakeCanvas");
      var context = canvas.getContext("2d");
      var score = 0;
      var snake =
      [
        {x:90, y:50},
        {x:80, y:50},
        {x:70, y:50},
        {x:60, y:50},
        {x:50, y:50}
      ];
      var dx = 10;
      var dy = 0;

      var x = Math.round(Math.floor(Math.random()*490)/10)*10;
      var y = Math.round(Math.floor(Math.random()*490)/10)*10;



      function drawSnakePart(snakePart){
        context.fillStyle = "green";
        context.strokestyle = "darkred";
        context.fillRect(snakePart.x, snakePart.y, 10, 10);
        context.strokeRect(snakePart.x, snakePart.y, 10, 10);
      }

      function drawSnake(){
        snake.forEach(drawSnakePart);
      }

      function advanceSnake(){
        var head = {x: snake[0].x + dx, y: snake[0].y + dy};
        snake.unshift(head);
        if(snake[0].x === x && snake[0].y === y)
        {
          x = Math.round(Math.floor(Math.random()*490)/10)*10;
          y = Math.round(Math.floor(Math.random()*490)/10)*10;
          score += 10;
          document.getElementById('score').innerHTML = score;
        }
        else {
          snake.pop();
        }

      }

      function clearCanvas(){
        context.fillStyle = "white";
        context.strokeStyle = "black";
        context.fillRect(0, 0, snakeCanvas.width, snakeCanvas.height);
        context.strokeRect(0, 0, snakeCanvas.width, snakeCanvas.height);

        context.fillStyle = "red";
        context.fillRect(x, y, 10, 10);
        context.strokeRect(x, y, 10, 10);

      }


      function end(){
        if((snake[0].x+10)>snakeCanvas.width)
        {
          return true;
        }
        if((snake[0].x+10)<10)
        {
          return true;
        }

        if((snake[0].y+10)>snakeCanvas.height)
        {
          return true;
        }
        if((snake[0].y+10) < 10)
        {
          return true;
        }
        for(var i = 1; i<snake.length; i++)
        {
          if(snake[i].x === snake[0].x && snake[i].y === snake[0].y)
          {
            return true;
          }
        }
      }

      function game(){
          if(end())
          {
            document.getElementById('x').innerHTML = "Refresh to restart the game!";
            return;
          }
          setTimeout(function onTick(){
            clearCanvas();
            advanceSnake();
            drawSnake();
            game();
          },100);
      }
      game();
      document.addEventListener("keydown", function (e) {
          switch (e.which) {
              case 37:
                  dx = -10;
                  dy = 0;
                  break;

              case 38:
                  dx = 0;
                  dy = -10;
                  break;
              case 39:
                  dx = 10;
                  dy = 0;
                  break;
              case 40:
                  dx = 0;
                  dy = 10;
                  break;
              default:
          }
      });



    </script>

  </body>
</html>
